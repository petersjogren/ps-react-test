(this["webpackJsonpps-react-test"]=this["webpackJsonpps-react-test"]||[]).push([[0],{212:function(e,t,n){e.exports=n(438)},243:function(e,t,n){},244:function(e,t,n){},245:function(e,t,n){},246:function(e,t,n){},438:function(e,t,n){"use strict";n.r(t);var o=n(1),r=n.n(o),s=n(8),i=n.n(s),a=n(25),c=n(46),d=n(28),l=n(86),p=n(79),u=n.n(p),m=999999;function f(e){return e?function(){var e=Object(l.a)(Array(202).keys()),t=e.map((function(t){return{nodeConfirmedInSessionWithID:"0",title:"Add",id:u()(),position:{x:600+500*Math.cos(6.28/e.length*t),y:600+500*Math.sin(6.28/e.length*t)},width:120,isSelected:!1,inputPorts:[{name:"x",type:"int"},{name:"y",type:"int"}],outputPorts:[{name:"sum",type:"int"}]}})),n=e.filter((function(e){return e%2===0})).map((function(t){return{confirmedInSessionWithID:"0",isSelected:!1,from:{nodeIndex:(t+e.length/2+2)%e.length,index:0},to:{nodeIndex:t,index:0}}}));return{serverGraph:{nodes:[],edges:[]},currentSessionID:"9999",pureHTMLgraph:!0,scale:.4,stressTest:!0,isDragInProgress:!1,dragPayload:{},dragMousePosition:{x:m,y:m},nodeTemplates:[{nodeConfirmedInSessionWithID:"0",title:"Add",id:213,position:{x:186,y:7},isSelected:!1,width:120,inputPorts:[{name:"a",type:"int"},{name:"b",type:"int"}],outputPorts:[{name:"sum",type:"int"}]},{nodeConfirmedInSessionWithID:"0",title:"Mult",id:213,position:{x:186,y:7},isSelected:!1,width:180,inputPorts:[{name:"x",type:"int"},{name:"y",type:"int"},{name:"z",type:"int"}],outputPorts:[{name:"sum",type:"int"}]},{nodeConfirmedInSessionWithID:"0",title:"Sub",id:213,position:{x:186,y:7},isSelected:!1,width:100,inputPorts:[{name:"x",type:"int"},{name:"y",type:"int"}],outputPorts:[{name:"sum",type:"int"}]},{nodeConfirmedInSessionWithID:"0",title:"Div",id:213,position:{x:186,y:7},isSelected:!1,width:120,inputPorts:[{name:"x",type:"int"},{name:"y",type:"int"}],outputPorts:[{name:"sum",type:"int"}]},{nodeConfirmedInSessionWithID:"0",title:"Add/Sub 4",id:213,position:{x:186,y:7},isSelected:!1,width:120,inputPorts:[{name:"x",type:"int"},{name:"y",type:"int"},{name:"z",type:"int"},{name:"w",type:"int"}],outputPorts:[{name:"sum",type:"int"},{name:"diff",type:"int"}]}],nodes:Object(l.a)(t),connections:Object(l.a)(n),textNode:{x:-500,y:-350,width:200,height:400,text:"Over hill, over dale, Thorough bush, thorough brier, Over park,\n            over pale, Thorough flood, thorough fire! I do wander everywhere,\n            Swifter than the moon's sphere; And I serve the Fairy Queen, To\n            dew her orbs upon the green; The cowslips tall her pensioners be;\n            In their gold coats spots you see; Those be rubies, fairy favours;\n            In those freckles live their savours; I must go seek some dewdrops\n            here, And hang a pearl in every cowslip's ear."},imgNode:{x:50,y:-350,width:400,height:300,url:"http://minerva-central.net/images/minerva-forward-m1.png"}}}():{serverGraph:{nodes:[],edges:[]},currentSessionID:"9999",pureHTMLgraph:!0,stressTest:!1,scale:.9,isDragInProgress:!1,dragPayload:{},dragMousePosition:{x:m,y:m},nodeTemplates:[{nodeConfirmedInSessionWithID:"0",title:"Add",id:213,position:{x:186,y:7},isSelected:!1,width:120,inputPorts:[{name:"a",type:"int"},{name:"b",type:"int"}],outputPorts:[{name:"sum",type:"int"}]},{nodeConfirmedInSessionWithID:"0",title:"Mult",id:213,position:{x:186,y:7},isSelected:!1,width:180,inputPorts:[{name:"x",type:"int"},{name:"y",type:"int"},{name:"z",type:"int"}],outputPorts:[{name:"sum",type:"int"}]},{nodeConfirmedInSessionWithID:"0",title:"Sub",id:213,position:{x:186,y:7},isSelected:!1,width:100,inputPorts:[{name:"x",type:"int"},{name:"y",type:"int"}],outputPorts:[{name:"sum",type:"int"}]},{nodeConfirmedInSessionWithID:"0",title:"Div",id:213,position:{x:186,y:7},isSelected:!1,width:120,inputPorts:[{name:"x",type:"int"},{name:"y",type:"int"}],outputPorts:[{name:"sum",type:"int"}]},{nodeConfirmedInSessionWithID:"0",title:"Add/Sub 4",id:213,position:{x:186,y:7},isSelected:!1,width:120,inputPorts:[{name:"x",type:"int"},{name:"y",type:"int"},{name:"z",type:"int"},{name:"w",type:"int"}],outputPorts:[{name:"sum",type:"int"},{name:"diff",type:"int"}]}],nodes:[{nodeConfirmedInSessionWithID:"c5e9a331-66b4-4461-8f3f-d319fa838195",title:"Add",id:"0523c8bf-d17e-49a5-918b-a91bca1b4ee9",position:{x:84.44444444444466,y:28.888888888889323},isSelected:!1,width:120,inputPorts:[{name:"a",type:"int"},{name:"b",type:"int"}],outputPorts:[{name:"sum",type:"int"}]},{nodeConfirmedInSessionWithID:"c5e9a331-66b4-4461-8f3f-d319fa838195",title:"Add",id:"02bf0700-c984-452e-b3c2-82de39114955",position:{x:507.7777777777772,y:231.1111111111114},isSelected:!1,width:120,inputPorts:[{name:"a",type:"int"},{name:"b",type:"int"}],outputPorts:[{name:"sum",type:"int"}]},{nodeConfirmedInSessionWithID:"c5e9a331-66b4-4461-8f3f-d319fa838195",title:"Sub",id:"44eeef82-abfe-4070-9f72-e854dd325991",position:{x:80.00000000000003,y:165.55555555555566},isSelected:!1,width:100,inputPorts:[{name:"x",type:"int"},{name:"y",type:"int"}],outputPorts:[{name:"sum",type:"int"}]},{nodeConfirmedInSessionWithID:"c5e9a331-66b4-4461-8f3f-d319fa838195",title:"Add/Sub 4",id:"3c753071-65f6-4fbe-9bf1-2d861c6186ca",position:{x:293.33333333333286,y:231.11111111111128},isSelected:!1,width:120,inputPorts:[{name:"x",type:"int"},{name:"y",type:"int"},{name:"z",type:"int"},{name:"w",type:"int"}],outputPorts:[{name:"sum",type:"int"},{name:"diff",type:"int"}]},{nodeConfirmedInSessionWithID:"c5e9a331-66b4-4461-8f3f-d319fa838195",title:"Mult",id:"0da44ac8-acab-47cd-b195-29e11008c869",position:{x:435.5555555555551,y:73.33333333333347},isSelected:!1,width:180,inputPorts:[{name:"x",type:"int"},{name:"y",type:"int"},{name:"z",type:"int"}],outputPorts:[{name:"sum",type:"int"}]}],connections:[{confirmedInSessionWithID:"0",isSelected:!1,from:{nodeIndex:3,index:0},to:{nodeIndex:1,index:0}},{confirmedInSessionWithID:"0",isSelected:!1,from:{nodeIndex:2,index:0},to:{nodeIndex:3,index:1}},{confirmedInSessionWithID:"0",isSelected:!1,from:{nodeIndex:0,index:0},to:{nodeIndex:4,index:1}},{confirmedInSessionWithID:"0",isSelected:!1,from:{nodeIndex:2,index:0},to:{nodeIndex:4,index:2}}],textNode:{x:500,y:350,width:200,height:400,text:"Over hill, over dale, Thorough bush, thorough brier, Over park,\n            over pale, Thorough flood, thorough fire! I do wander everywhere,\n            Swifter than the moon's sphere; And I serve the Fairy Queen, To\n            dew her orbs upon the green; The cowslips tall her pensioners be;\n            In their gold coats spots you see; Those be rubies, fairy favours;\n            In those freckles live their savours; I must go seek some dewdrops\n            here, And hang a pearl in every cowslip's ear."},imgNode:{x:50,y:350,width:400,height:300,url:"http://minerva-central.net/images/minerva-forward-m1.png"}}}var h,g=n(5),y=n.n(g),I=n(128),x=n.n(I),S=!1,v=[],b=null;function O(){window.WebSocket=window.WebSocket||window.MozWebSocket,h=new WebSocket("ws://127.0.0.1:1337"),console.log("websocket connection",h),h.onopen=function(){},h.onclose=function(){console.log("Connection closed"),st.dispatch(K(""))},h.onerror=function(e){window.alert('Websocket test server not started: start with "node websocket-test-server.js"',e.type)},h.onmessage=function(e){console.log("sessionID: "+e.data),st.dispatch(K(e.data)),h.onmessage=function(e){if(S)if(b(e),v.length>0){var t=v[0];v.shift(),b=t.successFunction,h.send(t.string)}else S=!1}}}function E(e,t){if(h.readyState===WebSocket.CLOSED)return"Error";S?v.push({string:e,successFunction:t}):(b=t,h.send(e),S=!0)}var D="CHANGE_ZOOM",w="POSITION_NODE",C="CREATE_NODE",P="POSITION_EVERY_OTHER_NODE",N="POSITION_TEXT_NODE",k="POSITION_IMG_NODE",T="TOGGLE_GRAPHICS",j="RESET_NORMAL",_="RESET_STRESS_TEST",R="CONNECT_PORTS",W="DELETE_SELECTED",M="SELECT_NODE",A="SELECT_CONNECTION",L="SELECT_CLEAR",$="SET_NODE_TEMPLATE_LIST",F="SET_CURRENT_SESSIONID",G="CONFIRM_NODE",U="CONFIRM_CONNECTION",J="RECONNECT_SERVER",z="OUTPORT_DRAG_STARTED",B="DRAG_CANCELLED",H="INPORT_DROP",X="DRAG_MOUSE_POSITION",Y="LOAD_STATE",V="DRAG_STOP",Z="SET_GRAPH_FROM_SERVER",Q=function(e,t,n,o){return function(r){var s=u()();r({type:C,x:e,y:t,index:n,nodeId:s}),E("addnode;"+s+";"+o,(function(e){console.log("answer",e);var t=JSON.parse(e.data);console.log("Response",t.type,t.nodeId,t.sessionId),r({type:G,nodeId:t.nodeId,sessionId:t.sessionId})}))}},q=function(e,t,n,o,r,s){return function(i){i({type:R,fromNodeIndex:e,fromPortIndex:t,toNodeIndex:n,toPortIndex:o}),E("addconnection;"+r+";"+t+";"+s+";"+o,(function(e){console.log("answer",e);var t=JSON.parse(e.data);console.log("Response",t),i({type:U,fromNodeId:t.fromNodeId,toNodeId:t.toNodeId,sessionId:t.sessionId})}))}},K=function(e){return console.log("set sessionID action",e),{type:F,id:e}},ee=n(34),te=n(129),ne=n.n(te),oe=ee.a.fromJS([]),re=ee.a.fromJS([]);function se(e){var t=ee.a.fromJS(e.nodes.map((function(e){return e.id}))),n=ee.a.fromJS(e.connections);console.log("node diff",ne()(oe,t).toJS()),console.log("connection diff",ne()(re,n).toJS()),oe=t,re=n}function ie(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function ae(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ie(Object(n),!0).forEach((function(t){Object(d.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ie(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ce="FROM_OUTPORT";function de(e,t,n,o,r){return y()(e,{connections:{$push:[{isSelected:!1,from:{nodeIndex:t,index:n},to:{nodeIndex:o,index:r}}]}})}function le(e){return y()(e,{isDragInProgress:{$set:!1},dragMousePosition:{x:{$set:m},y:{$set:m}},dragPayload:{$set:{}}})}n(243);var pe=n(10),ue=n(11),me=n(13),fe=n(12),he=n(14),ge=(n(244),n(245),function(e){function t(){return Object(pe.a)(this,t),Object(me.a)(this,Object(fe.a)(t).apply(this,arguments))}return Object(he.a)(t,e),Object(ue.a)(t,[{key:"shouldComponentUpdate",value:function(e,t){return this.props.templates.length!==e.templates.length}},{key:"render",value:function(){var e=this;return r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{onClick:this.props.onLoadDefault},"Load default"),r.a.createElement("button",{onClick:this.props.onLoadOther},"Load many"),this.props.templates.map((function(t,n){return r.a.createElement("div",{key:n,className:"nodelistitem",onClick:function(){return e.props.onCreateNode(n,t.title)},draggable:!0,onDragStart:function(e){var o=JSON.stringify({type:"CREATE_NODE",templateIndex:n,title:t.title});console.log("drag start",o),e.dataTransfer.setData("text/plain",o)}},t.title.substring(0,20))})))}}]),t}(r.a.Component)),ye=function(e){function t(){return Object(pe.a)(this,t),Object(me.a)(this,Object(fe.a)(t).apply(this,arguments))}return Object(he.a)(t,e),Object(ue.a)(t,[{key:"shouldComponentUpdate",value:function(e){var t=this.props,n=t.isSelected,o=t.isConfirmed,r=t.connectionIndex,s=t.curveColor,i=t.curveWidth,a=t.start,c=t.end,d=t.c1,l=t.c2;return e.connectionIndex!==r||e.isSelected!==n||e.isConfirmed!==o||e.curveColor!==s||e.curveWidth!==i||e.start.x!==a.x||e.start.y!==a.y||e.end.x!==c.x||e.end.y!==c.y||e.c1.x!==d.x||e.c1.y!==d.y||e.c2.x!==l.x||e.c2.y!==l.y}},{key:"render",value:function(){var e=this.props,t=e.isSelected,n=e.isConfirmed,o=e.connectionIndex,s=e.curveColor,i=e.curveWidth,a=e.start,c=e.end,d=e.c1,l=e.c2,p=e.onSelectConnection,u="M".concat(a.x,",").concat(a.y," C").concat(d.x,",").concat(d.y," ").concat(l.x,",").concat(l.y," ").concat(c.x,",").concat(c.y);return r.a.createElement("path",{onMouseDown:function(e){e.stopPropagation(),console.log("BezierCurve click"),p(o)},fill:"none",stroke:n?s:"red",strokeDasharray:t?4:0,strokeWidth:i,d:u})}}]),t}(r.a.Component),Ie=n(81),xe=n.n(Ie),Se=function(e){return r.a.createElement(xe.a,{key:e.key,scale:e.scale,position:e.position,onDrag:e.onDrag},r.a.createElement("div",{className:"box no-cursor"},r.a.createElement("svg",{className:"graphics inport"},r.a.createElement("circle",{className:"circle",xmlns:"http://www.w3.org/2000/svg",cx:"15",cy:"15",r:"15",style:{stroke:"#000000",strokeWidth:3,fill:"#66ff66"},opacity:".7"})),r.a.createElement("div",{className:"drag"},e.title),r.a.createElement("h3",null),r.a.createElement("svg",{className:"graphics outport",width:"30",height:"30"},r.a.createElement("circle",{className:"circle",xmlns:"http://www.w3.org/2000/svg",cx:"15",cy:"15",r:"15",style:{stroke:"#000000",strokeWidth:3,fill:"#ff0000"},opacity:".7"}))))},ve=(n(246),16),be=15;function Oe(e){var t=e.name,n=e.nodeIndex,o=e.portIndex;return r.a.createElement("div",{className:"port_area in"},r.a.createElement("div",{className:"port noselect",onMouseUp:function(t){t.stopPropagation(),console.log("mouse up in in port"),e.onInportDrop(n,o)}},"\u2192"),r.a.createElement("header",{className:"porttext in noselect"},t),r.a.createElement("div",{className:"noport noselect"}))}function Ee(e){var t=e.name;return r.a.createElement("div",{className:"port_area out"},r.a.createElement("div",{className:"noport noselect"}),r.a.createElement("header",{className:"porttext out noselect"},t),r.a.createElement("div",{className:"port noselect",onMouseDown:function(t){console.log("outport onmousedown. Begin out port drag"),e.onOutportDragStarted()}},"\u2192"))}function De(e,t){return{x:be/2,y:ve+ve*t+ve/2}}function we(e,t){return{x:e.width-be/2,y:ve+e.inputPorts.length*ve+t*ve+ve/2}}var Ce=function(e){function t(){return Object(pe.a)(this,t),Object(me.a)(this,Object(fe.a)(t).apply(this,arguments))}return Object(he.a)(t,e),Object(ue.a)(t,[{key:"shouldComponentUpdate",value:function(e){var t=this.props,n=t.nodeIndex,o=t.scale,r=t.positionX,s=t.positionY,i=t.width,a=t.isSelected,c=t.currentSessionID,d=t.nodeConfirmedInSessionWithID;return e.nodeIndex!==n||e.currentSessionID!==c||e.scale!==o||e.nodeConfirmedInSessionWithID!==d||e.positionX!==r||e.positionY!==s||e.width!==i||e.isSelected!==a}},{key:"render",value:function(){var e=this.props,t=e.title,n=e.nodeIndex,o=e.currentSessionID,s=e.nodeConfirmedInSessionWithID,i=e.scale,a=e.positionX,c=e.positionY,d=e.onDrag,l=e.width,p=e.inputPorts,u=e.outputPorts,m=e.isSelected,f=e.onSelectNode,h=e.onOutportDragStarted,g=e.onInportDrop,y=e.onDragStop,I=["node"];return m&&I.push("nodeselected"),o===s||I.push("notconfirmed"),r.a.createElement(xe.a,{scale:i,position:{x:a,y:c},onDrag:d,onStop:y,handle:"header",onMouseDown:function(e){e.stopPropagation(),console.log("node clicked"),f(n)}},r.a.createElement("div",{className:I.join(" "),style:{height:"".concat((p.length+u.length+1)*(ve-1),"px"),width:"".concat(l,"px")}},r.a.createElement("div",{className:"main_area"},r.a.createElement("div",{className:"addin noselect"},"+"),r.a.createElement("header",{className:"nodetext noselect"},t),r.a.createElement("div",{className:"addout noselect"},"+")),p.map((function(e,t){return r.a.createElement(Oe,{key:t,name:e.name,nodeIndex:n,portIndex:t,onInportDrop:g})})),u.map((function(e,t){return r.a.createElement(Ee,{key:t,name:e.name,nodeIndex:n,portIndex:t,onOutportDragStarted:function(){console.log("onOutportDragStarted"),h(n,t)}})}))))}}]),t}(r.a.Component),Pe=function(e){function t(){return Object(pe.a)(this,t),Object(me.a)(this,Object(fe.a)(t).apply(this,arguments))}return Object(he.a)(t,e),Object(ue.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement("div",{id:"nodearea",className:"nodearea bgpattern",onMouseDown:function(t){console.log("graphicsarea clicked"),e.props.onSelectClear()},onMouseUp:this.props.onDragCancelled,onMouseMove:function(t){var n=document.getElementById("nodearea").getBoundingClientRect(),o=(t.clientX-n.left)/e.props.scale,r=(t.clientY-n.top)/e.props.scale;e.props.isDragInProgress&&e.props.onDragMousePosition(o,r)},onDragOver:function(e){e.preventDefault()},onDrop:function(t){if(null!=t.dataTransfer){var n=t.dataTransfer.getData("text");if(console.log("textData",n),null!=n&&""!==n){var o=JSON.parse(n);if(console.log("dropped on nodearea",t,t.clientX,t.clientY),"CREATE_NODE"===o.type){var r=t.target.getBoundingClientRect(),s=(t.clientX-r.left)/e.props.scale,i=(t.clientY-r.top)/e.props.scale;e.props.onCreateNode(s,i,o.templateIndex,o.title)}}}}},r.a.createElement("div",{className:"graphicsarea",style:{transform:"scale("+this.props.scale+")"}},r.a.createElement("svg",{className:"arrowsvg",style:{position:"relative",top:"0px",left:"0px"}},function(){if(e.props.isDragInProgress&&e.props.dragPayload.type===ce&&e.props.dragMousePosition.x!==m){var t=e.props.nodes[e.props.dragPayload.nodeIndex],n=t.position.x+we(t,e.props.dragPayload.portIndex).x,o=t.position.y+we(t,e.props.dragPayload.portIndex).y,s=e.props.dragMousePosition.x,i=e.props.dragMousePosition.y;return r.a.createElement(ye,{key:0,isSelected:!1,connectionIndex:0,onSelectConnection:function(){},start:{x:n,y:o},end:{x:s,y:i},c1:{x:n+3*t.width/4,y:o},c2:{x:s-3*t.width/4,y:i},curveColor:"black",curveWidth:3})}}(),this.props.connections.map((function(t,n){var o=e.props.nodes[t.from.nodeIndex],s=e.props.nodes[t.to.nodeIndex],i=o.position.x+we(o,t.from.index).x,a=o.position.y+we(o,t.from.index).y,c=s.position.x+De(0,t.to.index).x,d=s.position.y+De(0,t.to.index).y;return r.a.createElement(ye,{key:n,isSelected:t.isSelected,isConfirmed:e.props.currentSessionID===t.confirmedInSessionWithID,connectionIndex:n,onSelectConnection:e.props.onSelectConnection,start:{x:i,y:a},end:{x:c,y:d},c1:{x:i+3*o.width/4,y:a},c2:{x:c-3*s.width/4,y:d},curveColor:"black",curveWidth:3})}))),this.props.nodes.map((function(t,n){return t.htmlNode?r.a.createElement(Se,{title:t.title,key:n,scale:e.props.scale,position:t.position,onDrag:function(t,o){e.props.onSetPosition(n,o,!1)}}):r.a.createElement(Ce,{title:t.title,key:n,nodeIndex:n,currentSessionID:e.props.currentSessionID,nodeConfirmedInSessionWithID:t.nodeConfirmedInSessionWithID,scale:e.props.scale,positionX:t.position.x,positionY:t.position.y,inputPorts:t.inputPorts,outputPorts:t.outputPorts,width:t.width,isSelected:t.isSelected,onDrag:function(t,o){e.props.onSetPosition(n,o,e.props.stressTest)},onDragStop:e.props.onDragStop,onSelectNode:e.props.onSelectNode,onOutportDragStarted:e.props.onOutportDragStarted,onInportDrop:function(t,n){e.props.onInportDrop(t,n,e.props.isDragInProgress,e.props.dragPayload,e.props.nodes[e.props.dragPayload.nodeIndex].id,e.props.nodes[t].id)}})}))))}}]),t}(r.a.Component),Ne=Object(a.b)((function(e){return{nodes:e.present.nodes,connections:e.present.connections,scale:e.present.scale,currentSessionID:e.present.currentSessionID,textNode:e.present.textNode,imgNode:e.present.imgNode,stressTest:e.present.stressTest,isDragInProgress:e.present.isDragInProgress,dragPayload:e.present.dragPayload,dragMousePosition:e.present.dragMousePosition}}),(function(e){return{onSetPosition:function(t,n,o){e(o?function(e,t){return{type:P,index:e,position:t}}(t,n):function(e,t){return{type:w,index:e,position:t}}(t,n))},onSetTextNodePosition:function(t){return e(function(e){return{type:N,position:e}}(t))},onSetImgNodePosition:function(t){return e(function(e){return{type:k,position:e}}(t))},onSelectNode:function(t){return e(function(e){return{type:M,nodeIndex:e}}(t))},onSelectConnection:function(t){return e(function(e){return{type:A,connectionIndex:e}}(t))},onSelectClear:function(){return e({type:L})},onCreateNode:function(t,n,o,r){return e(Q(t,n,o,r))},onOutportDragStarted:function(t,n){e(function(e,t){return{type:z,nodeIndex:e,portIndex:t}}(t,n))},onInportDrop:function(t,n,o,r,s,i){return e(function(e,t,n,o,r,s){return function(i){n&&o.type===ce&&(i({type:B}),i(q(o.nodeIndex,o.portIndex,e,t,r,s)))}}(t,n,o,r,s,i))},onDragStop:function(){return e({type:V})},onDragCancelled:function(){return e({type:B})},onDragMousePosition:function(t,n){return e(function(e,t){return{type:X,x:e,y:t}}(t,n))}}}))(Pe),ke=n(80),Te=n(82),je=n.n(Te);window.jQuery=window.$=je.a,n(247);var _e,Re=n(248),We=function(e){function t(){return Object(pe.a)(this,t),Object(me.a)(this,Object(fe.a)(t).apply(this,arguments))}return Object(he.a)(t,e),Object(ue.a)(t,[{key:"componentDidMount",value:function(){this.renderCanvas("mycanvasdraw2d")}},{key:"renderCanvas",value:function(e){var t=new Re.Canvas(e),n=new Re.shape.node.Start,o=new Re.shape.node.End;t.add(n,50,50),t.add(new Re.shape.node.Start,50,250),t.add(o,230,150);var r=new Re.Connection;r.setRouter(new Re.layout.connection.SplineConnectionRouter),r.setSourceDecorator(new Re.decoration.connection.BarDecorator),r.setTargetDecorator(new Re.decoration.connection.DiamondDecorator),r.setSource(n.getOutputPort(0)),r.setTarget(o.getInputPort(0)),t.add(r);var s=new Re.shape.analog.OpAmp;t.add(s,350,110);var i=new Re.shape.basic.Polygon,a=new Re.shape.basic.Polygon;t.add(i,450,150),t.add(a,450,200),a.setBackgroundColor("#f0f000"),a.setAlpha(.7),a.setDimension(100,60),t.setCurrentSelection(a);var c=new Re.shape.basic.Text;c.setText("This is a simple text with some loooooong word in."),c.setBackgroundColor("#f0f000"),t.add(c,550,10);var d=new Re.shape.basic.Label;d.setText("This is a label."),d.setBackgroundColor("#f0f000"),t.add(d,350,70);var l=new Re.shape.diagram.Pie(80,80);l.setWidth(100),l.setData([30,60,122,4]),t.add(l,600,160);var p=new Re.shape.note.PostIt;p.installEditor(new Re.ui.LabelInplaceEditor),p.setColor("#000000"),p.setPadding(20),p.setText("This is simple sticky note\nDouble click to edit."),t.add(p,700,10);var u=new Re.shape.basic.Label;u.installEditor(new Re.ui.LabelInplaceEditor),u.setText("Double click me to edit"),t.add(u,50,10),Re.Connection.createConnection=function(e,t){var n=new Re.Connection;return n.setRouter(new Re.layout.connection.FanConnectionRouter),n},n=new Re.shape.node.Start,o=new Re.shape.node.End,t.add(n,50,250),t.add(o,230,280),(r=Re.Connection.createConnection()).setSource(n.getOutputPort(0)),r.setTarget(o.getInputPort(0)),t.add(r),(r=Re.Connection.createConnection()).setSource(n.getOutputPort(0)),r.setTarget(o.getInputPort(0)),t.add(r),(r=Re.Connection.createConnection()).setSource(n.getOutputPort(0)),r.setTarget(o.getInputPort(0)),t.add(r),(r=Re.Connection.createConnection()).setSource(n.getOutputPort(0)),r.setTarget(o.getInputPort(0)),t.add(r),t.installEditPolicy(new Re.policy.canvas.WheelZoomPolicy),c=new Re.shape.basic.Text({text:"Use the mouse wheel + SHIFT to zoom"}),t.add(c,400,300),t.on("select",(function(e,t){null!==t.figure?console.log("figure selected"):console.log("selection cleared")})),je()("#mycanvasdraw2d").click((function(e){console.log("Mouse click:"+e.clientX+","+e.clientY)})),(new Re.io.json.Writer).marshal(t,(function(e){return console.log(e)}));var m=new(function(e){function t(e){var n;return Object(pe.a)(this,t),(n=Object(me.a)(this,Object(fe.a)(t).call(this,e))).index=0,n.svgs=[],n.svgs.push('<svg xmlns="http://www.w3.org/2000/svg">  <path stroke="#000" fill="#FFF" stroke-miterlimit="4" d="m0,49.842l0,-49.742l49.982,0l0,49.742l-49.982,0z" id="polygon3873"/>  <text text-anchor="middle" fill="#000000" font-family="Sans-serif" x="24.81563" y="26.50938" xml:space="preserve" font-size="8px" id="svg_1">Click me</text></svg>'),n.svgs.push('<svg xmlns="http://www.w3.org/2000/svg" version="1.1"><rect x="14" y="23" width="20" height="20" fill="lime" stroke="black" /></svg>'),n.on("click",(function(){this.index=++this.index%this.svgs.length,this.setSVG(this.svgs[this.index],500)}),Object(ke.a)(n)),n}return Object(he.a)(t,e),Object(ue.a)(t,[{key:"getSVG",value:function(){return this.svgs[0]}}]),t}(Re.SVGFigure));t.add(m,100,100)}},{key:"render",value:function(){return r.a.createElement("div",{id:"mycanvasdraw2d"})}}]),t}(r.a.Component),Me=(r.a.Component,n(249),n(204)),Ae=n.n(Me),Le=n(205),$e=(n(250),n(251),n(84)),Fe=n(130),Ge=Fe.a.Handle,Ue=function(e){var t=e.value,n=e.dragging,o=e.index,s=Object(Le.a)(e,["value","dragging","index"]);return r.a.createElement($e.a,{prefixCls:"rc-slider-tooltip",overlay:t,visible:n,placement:"top",key:o},r.a.createElement(Ge,Object.assign({value:t},s)))},Je=Object(a.b)()((function(e){return e.showControls?r.a.createElement("div",{className:"topbar"},r.a.createElement("div",{className:"zoom"},r.a.createElement(Fe.a,{min:20,max:150,value:e.scale,handle:Ue,onChange:e.onChange}))):r.a.createElement("div",{className:"topbar"})})),ze=n(33),Be=n.n(ze),He=n(209),Xe=n.n(He),Ye={select:function(e){}},Ve={layout:{hierarchical:!1},edges:{color:"#000000"}},Ze=function(e){function t(){return Object(pe.a)(this,t),Object(me.a)(this,Object(fe.a)(t).apply(this,arguments))}return Object(he.a)(t,e),Object(ue.a)(t,[{key:"shouldComponentUpdate",value:function(e){var t=ee.a.fromJS(e.serverGraph);return!ee.a.fromJS({nodes:this.props.serverGraph.nodes,edges:this.props.serverGraph.edges.map((function(e){return{from:e.from,to:e.to}}))}).equals(t)}},{key:"componentDidMount",value:function(){window.setInterval(this.props.onTimer,5e3)}},{key:"componentWillUnmount",value:function(){window.clearInterval()}},{key:"render",value:function(){return r.a.createElement("div",{className:"servergraph"},r.a.createElement("h1",null,"Server representation"),r.a.createElement(Xe.a,{graph:this.props.serverGraph,options:Ve,events:Ye,style:{height:"100%"}}))}}]),t}(r.a.Component),Qe=Object(a.b)((function(e){return{serverGraph:e.present.serverGraph}}),(function(e){return{onTimer:function(){return e((function(e){E("getgraph",(function(t){console.log("answer",t);var n=JSON.parse(t.data);console.log("Response",n.type,n.graph),e({type:Z,graph:n.graph})}))}))}}}))(Ze),qe=new FileReader,Ke=function(e){function t(){return Object(pe.a)(this,t),Object(me.a)(this,Object(fe.a)(t).apply(this,arguments))}return Object(he.a)(t,e),Object(ue.a)(t,[{key:"componentDidMount",value:function(){var e=this;document.body.addEventListener("keydown",(function(t){console.log("key down ",t,e),"Backspace"!==t.key&&"Delete"!==t.key||e.props.deleteSelected()})),O()}},{key:"componentWillUnmount",value:function(){}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"App noselect"},r.a.createElement("div",{className:"messagerow"},""===this.props.state.currentSessionID?"Server disconnected":"Server online",!0===this.props.state.isDragInProgress?" Draggning "+this.props.state.dragPayload.type:""),r.a.createElement("div",{className:"buttonrow",style:{display:"flex",justifyContent:"space-around"}},r.a.createElement("button",{onClick:this.props.reconnect},"New session"),r.a.createElement("button",{onClick:this.props.onUndo},"Undo (",this.props.sizePast,")"),r.a.createElement("button",{onClick:this.props.onRedo},"Redo (",this.props.sizeFuture,")"),r.a.createElement("button",{onClick:function(){var t=document.createElement("input");t.type="file",t.onchange=function(t){console.log("File loaded onchange"),_e=t.target.files[0],qe.readAsText(_e,"UTF-8"),qe.onload=function(t){console.log("File loaded");var n=t.target.result;e.props.onLoadStateFromString(n)}},t.click()}},"Load state"),r.a.createElement("button",{onClick:function(){var t=JSON.stringify(e.props.state,null,2),n=new Blob([t],{type:"text/plain;charset=utf-8"});Ae.a.saveAs(n,"state.json")}},"Save state"),r.a.createElement("button",{onClick:function(){return e.props.sync(e.props.state.currentSessionID,e.props.state.nodes,e.props.state.connections)}},"Sync"),r.a.createElement("button",{onClick:this.props.deleteSelected},"Del"),r.a.createElement("button",{onClick:this.props.resetStateNormal},"Some nodes"),r.a.createElement("button",{onClick:this.props.resetStateStressTest},"Stress test"),r.a.createElement("button",{onClick:this.props.toggleGraphicsLibrary},"Pure HTML / Draw2D")),r.a.createElement(Je,{className:"topbar",showControls:this.props.state.pureHTMLgraph,scale:100*this.props.state.scale,state:this.props.state,onChange:this.props.onZoomChange}),r.a.createElement("div",{className:"editor"},r.a.createElement("div",{className:"nodelist"},r.a.createElement(ge,{templates:this.props.state.nodeTemplates,onLoadDefault:this.props.onLoadDefault,onLoadOther:this.props.onLoadOther,onCreateNode:this.props.onCreateNode})),this.props.state.pureHTMLgraph?r.a.createElement(Ne,null):r.a.createElement(We,null),""===this.props.state.currentSessionID?"":r.a.createElement(Qe,null)))}}]),t}(r.a.Component),et=Object(a.b)((function(e){return{state:e.present,sizePast:e.past.length,sizeFuture:e.future.length}}),(function(e){return{deleteSelected:function(){return e({type:W})},onZoomChange:function(t){return e({type:D,percent:t})},toggleGraphicsLibrary:function(){return e({type:T})},resetStateNormal:function(){return e({type:j})},resetStateStressTest:function(){return e({type:_})},onLoadDefault:function(){return e((function(e){console.log("loadDefaultNodeTemplatesAsyncAction"),x.a.get("templates/defaultNodes.json").then((function(t){console.log(t),e({type:$,data:t.data})}))}))},onLoadOther:function(){return e((function(e){console.log("loadOtherNodeTemplatesAsyncAction"),x.a.get("templates/otherNodes.json").then((function(t){console.log(t),e({type:$,data:t.data})}))}))},reconnect:function(){return e((console.log("reconnectAction"),O(),{type:J}))},sync:function(t,n,o){e(function(e,t,n){return function(o){t.filter((function(t){return t.nodeConfirmedInSessionWithID!==e})).forEach((function(e){E("addnode;"+e.id+";"+e.title,(function(e){console.log("answer",e);var t=JSON.parse(e.data);console.log("Response",t.type,t.nodeId,t.sessionId),o({type:G,nodeId:t.nodeId,sessionId:t.sessionId})}))})),n.filter((function(t){return t.onfirmedInSessionWithID!==e})).forEach((function(e){E("addconnection;"+t[e.from.nodeIndex].id+";"+e.from.portIndex+";"+t[e.to.nodeIndex].id+";"+e.to.portIndex,(function(e){console.log("answer",e);var t=JSON.parse(e.data);console.log("Response",t),o({type:U,fromNodeId:t.fromNodeId,toNodeId:t.toNodeId,sessionId:t.sessionId})}))}))}}(t,n,o))},onLoadStateFromString:function(t){return e(function(e){return{type:Y,data:e}}(t))},onUndo:function(){return e(ze.ActionCreators.undo())},onRedo:function(){return e(ze.ActionCreators.redo())},onCreateNode:function(t,n){return e(Q(100,50,t,n))}}}))(Ke);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var tt=n(210),nt=n(211);n.d(t,"store",(function(){return st}));var ot=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||c.c,rt=Object(nt.createLogger)({collapsed:function(e,t){return t.type===w||t.type===X}}),st=Object(c.d)(Be()((function(){var e,t,n,o,r,s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:f(!1),i=arguments.length>1?arguments[1]:void 0;switch(i.type){case Y:var a=s.currentSessionID;e=JSON.parse(i.data),e=y()(e,{currentSessionID:{$set:a}});break;case D:e=y()(s,{scale:{$set:i.percent/100}});break;case W:var c,l,p,u;for(console.log("DELETE_SELECTED"),e=s,p=!0;p;)for(p=!1,c=0;c<e.nodes.length;c++)if(e.nodes[c].isSelected){for(e=y()(e,{nodes:{$splice:[[c,1]]}}),u=!0;u;)for(u=!1,l=0;l<e.connections.length;l++)if(e.connections[l].from.nodeIndex===c||e.connections[l].to.nodeIndex===c){e=y()(e,{connections:{$splice:[[l,1]]}}),u=!0;break}o={},e.connections.map((function(e,t){return o[t]={to:{nodeIndex:{$set:e.to.nodeIndex>c?e.to.nodeIndex-1:e.to.nodeIndex}},from:{nodeIndex:{$set:e.from.nodeIndex>c?e.from.nodeIndex-1:e.from.nodeIndex}}},null})),e=y()(e,{connections:ae({},o)}),p=!0;break}for(p=!0;p;)for(p=!1,c=0;c<e.connections.length;c++)if(e.connections[c].isSelected){e=y()(e,{connections:{$splice:[[c,1]]}}),p=!0;break}se(e);break;case M:console.log("SELECT_NODE",i.nodeIndex,s),e=y()(s,{nodes:Object(d.a)({},i.nodeIndex,{isSelected:{$set:!0}})});break;case C:console.log("CREATE_NODE",i.x,i.y,i),e=y()(s,{nodes:{$push:[s.nodeTemplates[i.index]]}}),e=y()(e,{nodes:Object(d.a)({},e.nodes.length-1,{position:{x:{$set:i.x-s.nodeTemplates[i.index].width/2},y:{$set:i.y-10}},id:{$set:i.nodeId}})}),console.log("state after ",e),se(e);break;case V:e=s;break;case G:console.log("CONFIRM_NODE",i.nodeId,i.sessionId,i);var m=function(e,t){var n=-1;return e.nodes.forEach((function(e,o){e.id===t&&(n=o)})),n}(s,i.nodeId);console.log("nodeIndex",m),e=y()(s,{currentSessionID:{$set:i.sessionId},nodes:Object(d.a)({},m,{nodeConfirmedInSessionWithID:{$set:i.sessionId}})});break;case U:console.log("CONFIRM_CONNECTION",i.sessionId,i);var h=function(e,t,n){for(var o=-1,r=0;r<e.connections.length;r++)if(e.nodes[e.connections[r].from.nodeIndex].id===t&&e.nodes[e.connections[r].to.nodeIndex].id===n){o=r;break}return o}(s,i.fromNodeId,i.toNodeId);console.log("connectionIndex",h),e=y()(s,{currentSessionID:{$set:i.sessionId},connections:Object(d.a)({},h,{confirmedInSessionWithID:{$set:i.sessionId}})});break;case z:console.log("OUTPORT_DRAG_STARTED",i.nodeIndex,i.portIndex),e=y()(s,{isDragInProgress:{$set:!0},dragPayload:{$set:{type:ce,nodeIndex:i.nodeIndex,portIndex:i.portIndex}}});break;case H:console.log("INPORT_DROP",i.nodeIndex,i.portIndex),e=s,s.isDragInProgress&&s.dragPayload.type===ce&&(e=de(e,s.dragPayload.nodeIndex,s.dragPayload.portIndex,i.nodeIndex,i.portIndex)),se(e=le(e));break;case B:e=le(s);break;case X:e=y()(s,{dragMousePosition:{x:{$set:i.x},y:{$set:i.y}}});break;case A:e=y()(s,{connections:Object(d.a)({},i.connectionIndex,{isSelected:{$set:!0}})});break;case L:o={},s.nodes.map((function(e,t){return o[t]={isSelected:{$set:!1}},null})),e=y()(s,{nodes:ae({},o)}),o={},s.connections.map((function(e,t){return o[t]={isSelected:{$set:!1}},null})),e=y()(e,{connections:ae({},o)});break;case w:e=y()(s,{nodes:Object(d.a)({},i.index,{position:{x:{$set:i.position.x},y:{$set:i.position.y}}})});break;case P:t=i.position.x-s.nodes[i.index].position.x,n=i.position.y-s.nodes[i.index].position.y,o={},s.nodes.map((function(e,r){return r%2===0&&(o[r]={position:{x:{$set:s.nodes[r].position.x+t},y:{$set:s.nodes[r].position.y+n}}}),null})),e=y()(s,{nodes:ae(Object(d.a)({},i.index,{position:{x:{$set:i.position.x},y:{$set:i.position.y}}}),o)});break;case N:e=y()(s,{textNode:{x:{$set:i.position.x},y:{$set:i.position.y}}});break;case k:e=y()(s,{imgNode:{x:{$set:i.position.x},y:{$set:i.position.y}}});break;case T:var g=!s.pureHTMLgraph;e=y()(s,{pureHTMLgraph:{$set:g}});break;case j:r=s.currentSessionID,e=f(!1),e=y()(e,{currentSessionID:{$set:r}});break;case _:r=s.currentSessionID,e=f(!0),e=y()(e,{currentSessionID:{$set:r}});break;case R:console.log("CONNECT_PORTS reducer"),e=le(e=de(s,i.fromNodeIndex,i.fromPortIndex,i.toNodeIndex,i.toPortIndex));break;case $:console.log("SET_NODE_TEMPLATE_LIST"),e=y()(s,{nodeTemplates:{$set:i.data.nodeTemplates}});break;case F:console.log("SET_CURRENT_SESSIONID",i),e=y()(s,{currentSessionID:{$set:i.id}});break;case J:e=s;break;case Z:e=e=y()(s,{serverGraph:{$set:i.graph}});break;default:console.log("default ",s),e=s}return e}),{groupBy:Object(ze.groupByActionTypes)([P,D]),filter:Object(ze.excludeAction)([w,G,U,z,H,X,B,L,M,Z])}),ot(Object(c.a)(tt.a,rt)));i.a.render(r.a.createElement(a.a,{store:st},r.a.createElement(et,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[212,1,2]]]);
//# sourceMappingURL=main.e0a5b08d.chunk.js.map