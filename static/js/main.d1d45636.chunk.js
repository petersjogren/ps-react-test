(this["webpackJsonpps-react-test"]=this["webpackJsonpps-react-test"]||[]).push([[0],{212:function(e,n,t){e.exports=t(438)},243:function(e,n,t){},244:function(e,n,t){},245:function(e,n,t){},246:function(e,n,t){},438:function(e,n,t){"use strict";t.r(n);var o=t(1),s=t.n(o),r=t(8),i=t.n(r),a=t(25),c=t(46),d=t(28),p=t(85),l=t(79),u=t.n(l),f=999999;function m(e){return e?function(){var e=Object(p.a)(Array(202).keys()),n=e.map((function(n){return{nodeConfirmedInSessionWithID:"0",title:"Add",id:u()(),position:{x:600+500*Math.cos(6.28/e.length*n),y:600+500*Math.sin(6.28/e.length*n)},width:120,isSelected:!1,inputPorts:[{name:"x",type:"int"},{name:"y",type:"int"}],outputPorts:[{name:"sum",type:"int"}]}})),t=e.filter((function(e){return e%2===0})).map((function(n){return{confirmedInSessionWithID:"0",isSelected:!1,from:{nodeIndex:(n+e.length/2+2)%e.length,index:0},to:{nodeIndex:n,index:0}}}));return{serverGraph:{nodes:[],edges:[]},currentSessionID:"9999",pureHTMLgraph:!0,scale:.4,stressTest:!0,isDragInProgress:!1,dragPayload:{},dragMousePosition:{x:f,y:f},nodeTemplates:[{nodeConfirmedInSessionWithID:"0",title:"Add",id:213,position:{x:186,y:7},isSelected:!1,width:120,inputPorts:[{name:"a",type:"int"},{name:"b",type:"int"}],outputPorts:[{name:"sum",type:"int"}]},{nodeConfirmedInSessionWithID:"0",title:"Mult",id:213,position:{x:186,y:7},isSelected:!1,width:180,inputPorts:[{name:"x",type:"int"},{name:"y",type:"int"},{name:"z",type:"int"}],outputPorts:[{name:"sum",type:"int"}]},{nodeConfirmedInSessionWithID:"0",title:"Sub",id:213,position:{x:186,y:7},isSelected:!1,width:100,inputPorts:[{name:"x",type:"int"},{name:"y",type:"int"}],outputPorts:[{name:"sum",type:"int"}]},{nodeConfirmedInSessionWithID:"0",title:"Div",id:213,position:{x:186,y:7},isSelected:!1,width:120,inputPorts:[{name:"x",type:"int"},{name:"y",type:"int"}],outputPorts:[{name:"sum",type:"int"}]},{nodeConfirmedInSessionWithID:"0",title:"Add/Sub 4",id:213,position:{x:186,y:7},isSelected:!1,width:120,inputPorts:[{name:"x",type:"int"},{name:"y",type:"int"},{name:"z",type:"int"},{name:"w",type:"int"}],outputPorts:[{name:"sum",type:"int"},{name:"diff",type:"int"}]}],nodes:Object(p.a)(n),connections:Object(p.a)(t)}}():{serverGraph:{nodes:[],edges:[]},currentSessionID:"9999",pureHTMLgraph:!0,stressTest:!1,scale:.9,isDragInProgress:!1,dragPayload:{},dragMousePosition:{x:f,y:f},nodeTemplates:[{nodeConfirmedInSessionWithID:"0",title:"Add",id:213,position:{x:186,y:7},isSelected:!1,width:120,inputPorts:[{name:"a",type:"int"},{name:"b",type:"int"}],outputPorts:[{name:"sum",type:"int"}]},{nodeConfirmedInSessionWithID:"0",title:"Mult",id:213,position:{x:186,y:7},isSelected:!1,width:180,inputPorts:[{name:"x",type:"int"},{name:"y",type:"int"},{name:"z",type:"int"}],outputPorts:[{name:"sum",type:"int"}]},{nodeConfirmedInSessionWithID:"0",title:"Sub",id:213,position:{x:186,y:7},isSelected:!1,width:100,inputPorts:[{name:"x",type:"int"},{name:"y",type:"int"}],outputPorts:[{name:"sum",type:"int"}]},{nodeConfirmedInSessionWithID:"0",title:"Div",id:213,position:{x:186,y:7},isSelected:!1,width:120,inputPorts:[{name:"x",type:"int"},{name:"y",type:"int"}],outputPorts:[{name:"sum",type:"int"}]},{nodeConfirmedInSessionWithID:"0",title:"Add/Sub 4",id:213,position:{x:186,y:7},isSelected:!1,width:120,inputPorts:[{name:"x",type:"int"},{name:"y",type:"int"},{name:"z",type:"int"},{name:"w",type:"int"}],outputPorts:[{name:"sum",type:"int"},{name:"diff",type:"int"}]}],nodes:[{nodeConfirmedInSessionWithID:"c5e9a331-66b4-4461-8f3f-d319fa838195",title:"Add",id:"0523c8bf-d17e-49a5-918b-a91bca1b4ee9",position:{x:84.44444444444466,y:28.888888888889323},isSelected:!1,width:120,inputPorts:[{name:"a",type:"int"},{name:"b",type:"int"}],outputPorts:[{name:"sum",type:"int"}]},{nodeConfirmedInSessionWithID:"c5e9a331-66b4-4461-8f3f-d319fa838195",title:"Add",id:"02bf0700-c984-452e-b3c2-82de39114955",position:{x:507.7777777777772,y:231.1111111111114},isSelected:!1,width:120,inputPorts:[{name:"a",type:"int"},{name:"b",type:"int"}],outputPorts:[{name:"sum",type:"int"}]},{nodeConfirmedInSessionWithID:"c5e9a331-66b4-4461-8f3f-d319fa838195",title:"Sub",id:"44eeef82-abfe-4070-9f72-e854dd325991",position:{x:80.00000000000003,y:165.55555555555566},isSelected:!1,width:100,inputPorts:[{name:"x",type:"int"},{name:"y",type:"int"}],outputPorts:[{name:"sum",type:"int"}]},{nodeConfirmedInSessionWithID:"c5e9a331-66b4-4461-8f3f-d319fa838195",title:"Add/Sub 4",id:"3c753071-65f6-4fbe-9bf1-2d861c6186ca",position:{x:293.33333333333286,y:231.11111111111128},isSelected:!1,width:120,inputPorts:[{name:"x",type:"int"},{name:"y",type:"int"},{name:"z",type:"int"},{name:"w",type:"int"}],outputPorts:[{name:"sum",type:"int"},{name:"diff",type:"int"}]},{nodeConfirmedInSessionWithID:"c5e9a331-66b4-4461-8f3f-d319fa838195",title:"Mult",id:"0da44ac8-acab-47cd-b195-29e11008c869",position:{x:435.5555555555551,y:73.33333333333347},isSelected:!1,width:180,inputPorts:[{name:"x",type:"int"},{name:"y",type:"int"},{name:"z",type:"int"}],outputPorts:[{name:"sum",type:"int"}]}],connections:[{confirmedInSessionWithID:"0",isSelected:!1,from:{nodeIndex:3,index:0},to:{nodeIndex:1,index:0}},{confirmedInSessionWithID:"0",isSelected:!1,from:{nodeIndex:2,index:0},to:{nodeIndex:3,index:1}},{confirmedInSessionWithID:"0",isSelected:!1,from:{nodeIndex:0,index:0},to:{nodeIndex:4,index:1}},{confirmedInSessionWithID:"0",isSelected:!1,from:{nodeIndex:2,index:0},to:{nodeIndex:4,index:2}}]}}var y,h=t(7),g=t.n(h),I=t(127),S=t.n(I),x=!1,b=[],v=null;function O(){window.WebSocket=window.WebSocket||window.MozWebSocket,y=new WebSocket("ws://127.0.0.1:1337"),console.log("websocket connection",y),y.onopen=function(){},y.onclose=function(){console.log("Connection closed"),tn.dispatch(q(""))},y.onerror=function(e){window.alert('Websocket test server not started: start with "node websocket-test-server.js"',e.type)},y.onmessage=function(e){console.log("sessionID: "+e.data),tn.dispatch(q(e.data)),y.onmessage=function(e){if(x)if(v(e),b.length>0){var n=b[0];b.shift(),v=n.successFunction,y.send(n.string)}else x=!1}}}function E(e,n){if(y.readyState===WebSocket.CLOSED)return"Error";x?b.push({string:e,successFunction:n}):(v=n,y.send(e),x=!0)}var D="CHANGE_ZOOM",C="POSITION_NODE",w="CREATE_NODE",P="POSITION_EVERY_OTHER_NODE",N="TOGGLE_GRAPHICS",k="RESET_NORMAL",T="RESET_STRESS_TEST",j="CONNECT_PORTS",R="DELETE_SELECTED",_="SELECT_NODE",W="SELECT_CONNECTION",M="SELECT_CLEAR",L="SET_NODE_TEMPLATE_LIST",A="SET_CURRENT_SESSIONID",$="CONFIRM_NODE",G="CONFIRM_CONNECTION",F="RECONNECT_SERVER",J="OUTPORT_DRAG_STARTED",U="DRAG_CANCELLED",z="INPORT_DROP",B="DRAG_MOUSE_POSITION",H="LOAD_STATE",X="DRAG_STOP",Y="SET_GRAPH_FROM_SERVER",V=function(e,n,t,o){return function(s){var r=u()();s({type:w,x:e,y:n,index:t,nodeId:r}),E("addnode;"+r+";"+o,(function(e){console.log("answer",e);var n=JSON.parse(e.data);console.log("Response",n.type,n.nodeId,n.sessionId),s({type:$,nodeId:n.nodeId,sessionId:n.sessionId})}))}},Z=function(e,n,t,o,s,r){return function(i){i({type:j,fromNodeIndex:e,fromPortIndex:n,toNodeIndex:t,toPortIndex:o}),E("addconnection;"+s+";"+n+";"+r+";"+o,(function(e){console.log("answer",e);var n=JSON.parse(e.data);console.log("Response",n),i({type:G,fromNodeId:n.fromNodeId,toNodeId:n.toNodeId,sessionId:n.sessionId})}))}},q=function(e){return console.log("set sessionID action",e),{type:A,id:e}},Q=t(34),K=t(128),ee=t.n(K),ne=Q.a.fromJS([]),te=Q.a.fromJS([]);function oe(e){var n=Q.a.fromJS(e.nodes.map((function(e){return e.id}))),t=Q.a.fromJS(e.connections);console.log("node diff",ee()(ne,n).toJS()),console.log("connection diff",ee()(te,t).toJS()),ne=n,te=t}function se(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,o)}return t}function re(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?se(Object(t),!0).forEach((function(n){Object(d.a)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):se(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var ie="FROM_OUTPORT";function ae(e,n,t,o,s){return g()(e,{connections:{$push:[{isSelected:!1,from:{nodeIndex:n,index:t},to:{nodeIndex:o,index:s}}]}})}function ce(e){return g()(e,{isDragInProgress:{$set:!1},dragMousePosition:{x:{$set:f},y:{$set:f}},dragPayload:{$set:{}}})}t(243);var de=t(10),pe=t(11),le=t(13),ue=t(12),fe=t(14),me=(t(244),t(245),function(e){function n(){return Object(de.a)(this,n),Object(le.a)(this,Object(ue.a)(n).apply(this,arguments))}return Object(fe.a)(n,e),Object(pe.a)(n,[{key:"shouldComponentUpdate",value:function(e,n){return this.props.templates.length!==e.templates.length}},{key:"render",value:function(){var e=this;return s.a.createElement(s.a.Fragment,null,s.a.createElement("button",{onClick:this.props.onLoadDefault},"Load default"),s.a.createElement("button",{onClick:this.props.onLoadOther},"Load many"),this.props.templates.map((function(n,t){return s.a.createElement("div",{key:t,className:"nodelistitem",onClick:function(){return e.props.onCreateNode(t,n.title)},draggable:!0,onDragStart:function(e){var o=JSON.stringify({type:"CREATE_NODE",templateIndex:t,title:n.title});console.log("drag start",o),e.dataTransfer.setData("text/plain",o)}},n.title.substring(0,20))})))}}]),n}(s.a.Component)),ye=function(e){function n(){return Object(de.a)(this,n),Object(le.a)(this,Object(ue.a)(n).apply(this,arguments))}return Object(fe.a)(n,e),Object(pe.a)(n,[{key:"shouldComponentUpdate",value:function(e){var n=this.props,t=n.isSelected,o=n.isConfirmed,s=n.connectionIndex,r=n.curveColor,i=n.curveWidth,a=n.start,c=n.end,d=n.c1,p=n.c2;return e.connectionIndex!==s||e.isSelected!==t||e.isConfirmed!==o||e.curveColor!==r||e.curveWidth!==i||e.start.x!==a.x||e.start.y!==a.y||e.end.x!==c.x||e.end.y!==c.y||e.c1.x!==d.x||e.c1.y!==d.y||e.c2.x!==p.x||e.c2.y!==p.y}},{key:"render",value:function(){var e=this.props,n=e.isSelected,t=e.isConfirmed,o=e.connectionIndex,r=e.curveColor,i=e.curveWidth,a=e.start,c=e.end,d=e.c1,p=e.c2,l=e.onSelectConnection,u="M".concat(a.x,",").concat(a.y," C").concat(d.x,",").concat(d.y," ").concat(p.x,",").concat(p.y," ").concat(c.x,",").concat(c.y);return s.a.createElement("path",{onMouseDown:function(e){e.stopPropagation(),console.log("BezierCurve click"),l(o)},fill:"none",stroke:t?r:"red",strokeDasharray:n?4:0,strokeWidth:i,d:u})}}]),n}(s.a.Component),he=t(203),ge=t.n(he),Ie=(t(246),16),Se=15;function xe(e){var n=e.name,t=e.nodeIndex,o=e.portIndex;return s.a.createElement("div",{className:"port_area in"},s.a.createElement("div",{className:"port noselect",onMouseUp:function(n){n.stopPropagation(),console.log("mouse up in in port"),e.onInportDrop(t,o)}},"\u2192"),s.a.createElement("header",{className:"porttext in noselect"},n),s.a.createElement("div",{className:"noport noselect"}))}function be(e){var n=e.name;return s.a.createElement("div",{className:"port_area out"},s.a.createElement("div",{className:"noport noselect"}),s.a.createElement("header",{className:"porttext out noselect"},n),s.a.createElement("div",{className:"port noselect",onMouseDown:function(n){console.log("outport onmousedown. Begin out port drag"),e.onOutportDragStarted()}},"\u2192"))}function ve(e,n){return{x:Se/2,y:Ie+Ie*n+Ie/2}}function Oe(e,n){return{x:e.width-Se/2,y:Ie+e.inputPorts.length*Ie+n*Ie+Ie/2}}var Ee=function(e){function n(){return Object(de.a)(this,n),Object(le.a)(this,Object(ue.a)(n).apply(this,arguments))}return Object(fe.a)(n,e),Object(pe.a)(n,[{key:"shouldComponentUpdate",value:function(e){var n=this.props,t=n.nodeIndex,o=n.scale,s=n.positionX,r=n.positionY,i=n.width,a=n.isSelected,c=n.currentSessionID,d=n.nodeConfirmedInSessionWithID;return e.nodeIndex!==t||e.currentSessionID!==c||e.scale!==o||e.nodeConfirmedInSessionWithID!==d||e.positionX!==s||e.positionY!==r||e.width!==i||e.isSelected!==a}},{key:"render",value:function(){var e=this.props,n=e.title,t=e.nodeIndex,o=e.currentSessionID,r=e.nodeConfirmedInSessionWithID,i=e.scale,a=e.positionX,c=e.positionY,d=e.onDrag,p=e.width,l=e.inputPorts,u=e.outputPorts,f=e.isSelected,m=e.onSelectNode,y=e.onOutportDragStarted,h=e.onInportDrop,g=e.onDragStop,I=["node"];return f&&I.push("nodeselected"),o===r||I.push("notconfirmed"),s.a.createElement(ge.a,{scale:i,position:{x:a,y:c},onDrag:d,onStop:g,handle:"header",onMouseDown:function(e){e.stopPropagation(),console.log("node clicked"),m(t)}},s.a.createElement("div",{className:I.join(" "),style:{height:"".concat((l.length+u.length+1)*(Ie-1),"px"),width:"".concat(p,"px")}},s.a.createElement("div",{className:"main_area"},s.a.createElement("div",{className:"addin noselect"},"+"),s.a.createElement("header",{className:"nodetext noselect"},n),s.a.createElement("div",{className:"addout noselect"},"+")),l.map((function(e,n){return s.a.createElement(xe,{key:n,name:e.name,nodeIndex:t,portIndex:n,onInportDrop:h})})),u.map((function(e,n){return s.a.createElement(be,{key:n,name:e.name,nodeIndex:t,portIndex:n,onOutportDragStarted:function(){console.log("onOutportDragStarted"),y(t,n)}})}))))}}]),n}(s.a.Component),De=function(e){function n(){return Object(de.a)(this,n),Object(le.a)(this,Object(ue.a)(n).apply(this,arguments))}return Object(fe.a)(n,e),Object(pe.a)(n,[{key:"render",value:function(){var e=this;return s.a.createElement("div",{id:"nodearea",className:"nodearea bgpattern",onMouseDown:function(n){console.log("graphicsarea clicked"),e.props.onSelectClear()},onMouseUp:this.props.onDragCancelled,onMouseMove:function(n){var t=document.getElementById("nodearea").getBoundingClientRect(),o=(n.clientX-t.left)/e.props.scale,s=(n.clientY-t.top)/e.props.scale;e.props.isDragInProgress&&e.props.onDragMousePosition(o,s)},onDragOver:function(e){e.preventDefault()},onDrop:function(n){if(null!=n.dataTransfer){var t=n.dataTransfer.getData("text");if(console.log("textData",t),null!=t&&""!==t){var o=JSON.parse(t);if(console.log("dropped on nodearea",n,n.clientX,n.clientY),"CREATE_NODE"===o.type){var s=n.target.getBoundingClientRect(),r=(n.clientX-s.left)/e.props.scale,i=(n.clientY-s.top)/e.props.scale;e.props.onCreateNode(r,i,o.templateIndex,o.title)}}}}},s.a.createElement("div",{className:"graphicsarea",style:{transform:"scale("+this.props.scale+")"}},s.a.createElement("svg",{className:"arrowsvg",style:{position:"relative",top:"0px",left:"0px"}},function(){if(e.props.isDragInProgress&&e.props.dragPayload.type===ie&&e.props.dragMousePosition.x!==f){var n=e.props.nodes[e.props.dragPayload.nodeIndex],t=n.position.x+Oe(n,e.props.dragPayload.portIndex).x,o=n.position.y+Oe(n,e.props.dragPayload.portIndex).y,r=e.props.dragMousePosition.x,i=e.props.dragMousePosition.y;return s.a.createElement(ye,{key:0,isSelected:!1,connectionIndex:0,onSelectConnection:function(){},start:{x:t,y:o},end:{x:r,y:i},c1:{x:t+3*n.width/4,y:o},c2:{x:r-3*n.width/4,y:i},curveColor:"black",curveWidth:3})}}(),this.props.connections.map((function(n,t){var o=e.props.nodes[n.from.nodeIndex],r=e.props.nodes[n.to.nodeIndex],i=o.position.x+Oe(o,n.from.index).x,a=o.position.y+Oe(o,n.from.index).y,c=r.position.x+ve(0,n.to.index).x,d=r.position.y+ve(0,n.to.index).y;return s.a.createElement(ye,{key:t,isSelected:n.isSelected,isConfirmed:e.props.currentSessionID===n.confirmedInSessionWithID,connectionIndex:t,onSelectConnection:e.props.onSelectConnection,start:{x:i,y:a},end:{x:c,y:d},c1:{x:i+3*o.width/4,y:a},c2:{x:c-3*r.width/4,y:d},curveColor:"black",curveWidth:3})}))),this.props.nodes.map((function(n,t){return s.a.createElement(Ee,{title:n.title,key:t,nodeIndex:t,currentSessionID:e.props.currentSessionID,nodeConfirmedInSessionWithID:n.nodeConfirmedInSessionWithID,scale:e.props.scale,positionX:n.position.x,positionY:n.position.y,inputPorts:n.inputPorts,outputPorts:n.outputPorts,width:n.width,isSelected:n.isSelected,onDrag:function(n,o){e.props.onSetPosition(t,o,e.props.stressTest)},onDragStop:e.props.onDragStop,onSelectNode:e.props.onSelectNode,onOutportDragStarted:e.props.onOutportDragStarted,onInportDrop:function(n,t){e.props.isDragInProgress&&e.props.onInportDrop(n,t,e.props.isDragInProgress,e.props.dragPayload,e.props.nodes[e.props.dragPayload.nodeIndex].id,e.props.nodes[n].id)}})}))))}}]),n}(s.a.Component),Ce=Object(a.b)((function(e){return{nodes:e.present.nodes,connections:e.present.connections,scale:e.present.scale,currentSessionID:e.present.currentSessionID,stressTest:e.present.stressTest,isDragInProgress:e.present.isDragInProgress,dragPayload:e.present.dragPayload,dragMousePosition:e.present.dragMousePosition}}),(function(e){return{onSetPosition:function(n,t,o){e(o?function(e,n){return{type:P,index:e,position:n}}(n,t):function(e,n){return{type:C,index:e,position:n}}(n,t))},onSelectNode:function(n){return e(function(e){return{type:_,nodeIndex:e}}(n))},onSelectConnection:function(n){return e(function(e){return{type:W,connectionIndex:e}}(n))},onSelectClear:function(){return e({type:M})},onCreateNode:function(n,t,o,s){return e(V(n,t,o,s))},onOutportDragStarted:function(n,t){e(function(e,n){return{type:J,nodeIndex:e,portIndex:n}}(n,t))},onInportDrop:function(n,t,o,s,r,i){return e(function(e,n,t,o,s,r){return function(i){t&&o.type===ie&&(i({type:U}),i(Z(o.nodeIndex,o.portIndex,e,n,s,r)))}}(n,t,o,s,r,i))},onDragStop:function(){return e({type:X})},onDragCancelled:function(){return e({type:U})},onDragMousePosition:function(n,t){return e(function(e,n){return{type:B,x:e,y:n}}(n,t))}}}))(De),we=t(80),Pe=t(81),Ne=t.n(Pe);window.jQuery=window.$=Ne.a,t(247);var ke,Te=t(248),je=function(e){function n(){return Object(de.a)(this,n),Object(le.a)(this,Object(ue.a)(n).apply(this,arguments))}return Object(fe.a)(n,e),Object(pe.a)(n,[{key:"componentDidMount",value:function(){this.renderCanvas("mycanvasdraw2d")}},{key:"renderCanvas",value:function(e){var n=new Te.Canvas(e),t=new Te.shape.node.Start,o=new Te.shape.node.End;n.add(t,50,50),n.add(new Te.shape.node.Start,50,250),n.add(o,230,150);var s=new Te.Connection;s.setRouter(new Te.layout.connection.SplineConnectionRouter),s.setSourceDecorator(new Te.decoration.connection.BarDecorator),s.setTargetDecorator(new Te.decoration.connection.DiamondDecorator),s.setSource(t.getOutputPort(0)),s.setTarget(o.getInputPort(0)),n.add(s);var r=new Te.shape.analog.OpAmp;n.add(r,350,110);var i=new Te.shape.basic.Polygon,a=new Te.shape.basic.Polygon;n.add(i,450,150),n.add(a,450,200),a.setBackgroundColor("#f0f000"),a.setAlpha(.7),a.setDimension(100,60),n.setCurrentSelection(a);var c=new Te.shape.basic.Text;c.setText("This is a simple text with some loooooong word in."),c.setBackgroundColor("#f0f000"),n.add(c,550,10);var d=new Te.shape.basic.Label;d.setText("This is a label."),d.setBackgroundColor("#f0f000"),n.add(d,350,70);var p=new Te.shape.diagram.Pie(80,80);p.setWidth(100),p.setData([30,60,122,4]),n.add(p,600,160);var l=new Te.shape.note.PostIt;l.installEditor(new Te.ui.LabelInplaceEditor),l.setColor("#000000"),l.setPadding(20),l.setText("This is simple sticky note\nDouble click to edit."),n.add(l,700,10);var u=new Te.shape.basic.Label;u.installEditor(new Te.ui.LabelInplaceEditor),u.setText("Double click me to edit"),n.add(u,50,10),Te.Connection.createConnection=function(e,n){var t=new Te.Connection;return t.setRouter(new Te.layout.connection.FanConnectionRouter),t},t=new Te.shape.node.Start,o=new Te.shape.node.End,n.add(t,50,250),n.add(o,230,280),(s=Te.Connection.createConnection()).setSource(t.getOutputPort(0)),s.setTarget(o.getInputPort(0)),n.add(s),(s=Te.Connection.createConnection()).setSource(t.getOutputPort(0)),s.setTarget(o.getInputPort(0)),n.add(s),(s=Te.Connection.createConnection()).setSource(t.getOutputPort(0)),s.setTarget(o.getInputPort(0)),n.add(s),(s=Te.Connection.createConnection()).setSource(t.getOutputPort(0)),s.setTarget(o.getInputPort(0)),n.add(s),n.installEditPolicy(new Te.policy.canvas.WheelZoomPolicy),c=new Te.shape.basic.Text({text:"Use the mouse wheel + SHIFT to zoom"}),n.add(c,400,300),n.on("select",(function(e,n){null!==n.figure?console.log("figure selected"):console.log("selection cleared")})),Ne()("#mycanvasdraw2d").click((function(e){console.log("Mouse click:"+e.clientX+","+e.clientY)})),(new Te.io.json.Writer).marshal(n,(function(e){return console.log(e)}));var f=new(function(e){function n(e){var t;return Object(de.a)(this,n),(t=Object(le.a)(this,Object(ue.a)(n).call(this,e))).index=0,t.svgs=[],t.svgs.push('<svg xmlns="http://www.w3.org/2000/svg">  <path stroke="#000" fill="#FFF" stroke-miterlimit="4" d="m0,49.842l0,-49.742l49.982,0l0,49.742l-49.982,0z" id="polygon3873"/>  <text text-anchor="middle" fill="#000000" font-family="Sans-serif" x="24.81563" y="26.50938" xml:space="preserve" font-size="8px" id="svg_1">Click me</text></svg>'),t.svgs.push('<svg xmlns="http://www.w3.org/2000/svg" version="1.1"><rect x="14" y="23" width="20" height="20" fill="lime" stroke="black" /></svg>'),t.on("click",(function(){this.index=++this.index%this.svgs.length,this.setSVG(this.svgs[this.index],500)}),Object(we.a)(t)),t}return Object(fe.a)(n,e),Object(pe.a)(n,[{key:"getSVG",value:function(){return this.svgs[0]}}]),n}(Te.SVGFigure));n.add(f,100,100)}},{key:"render",value:function(){return s.a.createElement("div",{id:"mycanvasdraw2d"})}}]),n}(s.a.Component),Re=(s.a.Component,t(249),t(204)),_e=t.n(Re),We=t(205),Me=(t(250),t(251),t(83)),Le=t(129),Ae=Le.a.Handle,$e=function(e){var n=e.value,t=e.dragging,o=e.index,r=Object(We.a)(e,["value","dragging","index"]);return s.a.createElement(Me.a,{prefixCls:"rc-slider-tooltip",overlay:n,visible:t,placement:"top",key:o},s.a.createElement(Ae,Object.assign({value:n},r)))},Ge=Object(a.b)()((function(e){return e.showControls?s.a.createElement("div",{className:"topbar"},s.a.createElement("div",{className:"zoom"},s.a.createElement(Le.a,{min:20,max:150,value:e.scale,handle:$e,onChange:e.onChange}))):s.a.createElement("div",{className:"topbar"})})),Fe=t(33),Je=t.n(Fe),Ue=t(209),ze=t.n(Ue),Be={select:function(e){}},He={layout:{hierarchical:!1},edges:{color:"#000000"}},Xe=function(e){function n(){return Object(de.a)(this,n),Object(le.a)(this,Object(ue.a)(n).apply(this,arguments))}return Object(fe.a)(n,e),Object(pe.a)(n,[{key:"shouldComponentUpdate",value:function(e){var n=Q.a.fromJS(e.serverGraph);return!Q.a.fromJS({nodes:this.props.serverGraph.nodes,edges:this.props.serverGraph.edges.map((function(e){return{from:e.from,to:e.to}}))}).equals(n)}},{key:"componentDidMount",value:function(){window.setInterval(this.props.onTimer,5e3)}},{key:"componentWillUnmount",value:function(){window.clearInterval()}},{key:"render",value:function(){return s.a.createElement("div",{className:"servergraph"},s.a.createElement("h1",null,"Server representation"),s.a.createElement(ze.a,{graph:this.props.serverGraph,options:He,events:Be,style:{height:"100%"}}))}}]),n}(s.a.Component),Ye=Object(a.b)((function(e){return{serverGraph:e.present.serverGraph}}),(function(e){return{onTimer:function(){return e((function(e){E("getgraph",(function(n){console.log("answer",n);var t=JSON.parse(n.data);console.log("Response",t.type,t.graph),e({type:Y,graph:t.graph})}))}))}}}))(Xe),Ve=new FileReader,Ze=function(e){function n(){return Object(de.a)(this,n),Object(le.a)(this,Object(ue.a)(n).apply(this,arguments))}return Object(fe.a)(n,e),Object(pe.a)(n,[{key:"componentDidMount",value:function(){var e=this;document.body.addEventListener("keydown",(function(n){console.log("key down ",n,e),"Backspace"!==n.key&&"Delete"!==n.key||e.props.deleteSelected(e.props.state)})),O()}},{key:"componentWillUnmount",value:function(){}},{key:"render",value:function(){var e=this;return s.a.createElement("div",{className:"App noselect"},s.a.createElement("div",{className:"messagerow"},""===this.props.state.currentSessionID?"Server disconnected":"Server online",!0===this.props.state.isDragInProgress?" Draggning "+this.props.state.dragPayload.type:""),s.a.createElement("div",{className:"buttonrow",style:{display:"flex",justifyContent:"space-around"}},s.a.createElement("button",{onClick:this.props.reconnect},"New session"),s.a.createElement("button",{onClick:this.props.onUndo},"Undo (",this.props.sizePast,")"),s.a.createElement("button",{onClick:this.props.onRedo},"Redo (",this.props.sizeFuture,")"),s.a.createElement("button",{onClick:function(){var n=document.createElement("input");n.type="file",n.onchange=function(n){console.log("File loaded onchange"),ke=n.target.files[0],Ve.readAsText(ke,"UTF-8"),Ve.onload=function(n){console.log("File loaded");var t=n.target.result;e.props.onLoadStateFromString(t)}},n.click()}},"Load state"),s.a.createElement("button",{onClick:function(){var n=JSON.stringify(e.props.state,null,2),t=new Blob([n],{type:"text/plain;charset=utf-8"});_e.a.saveAs(t,"state.json")}},"Save state"),s.a.createElement("button",{onClick:function(){return e.props.sync(e.props.state.currentSessionID,e.props.state.nodes,e.props.state.connections)}},"Sync"),s.a.createElement("button",{onClick:function(){return e.props.deleteSelected(e.props.state)}},"Del"),s.a.createElement("button",{onClick:this.props.resetStateNormal},"Some nodes"),s.a.createElement("button",{onClick:this.props.resetStateStressTest},"Stress test"),s.a.createElement("button",{onClick:this.props.toggleGraphicsLibrary},"Pure HTML / Draw2D")),s.a.createElement(Ge,{className:"topbar",showControls:this.props.state.pureHTMLgraph,scale:100*this.props.state.scale,state:this.props.state,onChange:this.props.onZoomChange}),s.a.createElement("div",{className:"editor"},s.a.createElement("div",{className:"nodelist"},s.a.createElement(me,{templates:this.props.state.nodeTemplates,onLoadDefault:this.props.onLoadDefault,onLoadOther:this.props.onLoadOther,onCreateNode:this.props.onCreateNode})),this.props.state.pureHTMLgraph?s.a.createElement(Ce,null):s.a.createElement(je,null),""===this.props.state.currentSessionID?"":s.a.createElement(Ye,null)))}}]),n}(s.a.Component),qe=Object(a.b)((function(e){return{state:e.present,sizePast:e.past.length,sizeFuture:e.future.length}}),(function(e,n){return{deleteSelected:function(n){return e(function(e){return function(n){var t=new Set(e.nodes.map((function(e,n){return e.isSelected?n:-1})).filter((function(e){return-1!==e})));e.connections.forEach((function(n){(n.isSelected||t.has(n.from.nodeIndex)||t.has(n.to.nodeIndex))&&E("deleteconnection;"+e.nodes[n.from.nodeIndex].id+";"+e.nodes[n.to.nodeIndex].id,(function(e){console.log("answer",e);var n=JSON.parse(e.data);console.log("Response",n.type,n.nodeId,n.sessionId)}))})),e.nodes.forEach((function(e){e.isSelected&&E("deletenode;"+e.id,(function(e){console.log("answer",e);var n=JSON.parse(e.data);console.log("Response",n.type,n.nodeId,n.sessionId)}))})),n({type:R})}}(n))},onZoomChange:function(n){return e({type:D,percent:n})},toggleGraphicsLibrary:function(){return e({type:N})},resetStateNormal:function(){return e({type:k})},resetStateStressTest:function(){return e({type:T})},onLoadDefault:function(){return e((function(e){console.log("loadDefaultNodeTemplatesAsyncAction"),S.a.get("templates/defaultNodes.json").then((function(n){console.log(n),e({type:L,data:n.data})}))}))},onLoadOther:function(){return e((function(e){console.log("loadOtherNodeTemplatesAsyncAction"),S.a.get("templates/otherNodes.json").then((function(n){console.log(n),e({type:L,data:n.data})}))}))},reconnect:function(){return e((console.log("reconnectAction"),O(),{type:F}))},sync:function(n,t,o){e(function(e,n,t){return function(o){n.filter((function(n){return n.nodeConfirmedInSessionWithID!==e})).forEach((function(e){E("addnode;"+e.id+";"+e.title,(function(e){console.log("answer",e);var n=JSON.parse(e.data);console.log("Response",n.type,n.nodeId,n.sessionId),o({type:$,nodeId:n.nodeId,sessionId:n.sessionId})}))})),t.filter((function(n){return n.onfirmedInSessionWithID!==e})).forEach((function(e){E("addconnection;"+n[e.from.nodeIndex].id+";"+e.from.portIndex+";"+n[e.to.nodeIndex].id+";"+e.to.portIndex,(function(e){console.log("answer",e);var n=JSON.parse(e.data);console.log("Response",n),o({type:G,fromNodeId:n.fromNodeId,toNodeId:n.toNodeId,sessionId:n.sessionId})}))}))}}(n,t,o))},onLoadStateFromString:function(n){return e(function(e){return{type:H,data:e}}(n))},onUndo:function(){return e(Fe.ActionCreators.undo())},onRedo:function(){return e(Fe.ActionCreators.redo())},onCreateNode:function(n,t){return e(V(100,50,n,t))}}}))(Ze);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var Qe=t(210),Ke=t(211);t.d(n,"store",(function(){return tn}));var en=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||c.c,nn=Object(Ke.createLogger)({collapsed:function(e,n){return n.type===C||n.type===B}}),tn=Object(c.d)(Je()((function(){var e,n,t,o,s,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:m(!1),i=arguments.length>1?arguments[1]:void 0;switch(i.type){case H:var a=r.currentSessionID;e=JSON.parse(i.data),e=g()(e,{currentSessionID:{$set:a}});break;case D:e=g()(r,{scale:{$set:i.percent/100}});break;case R:var c,p,l,u;for(console.log("DELETE_SELECTED"),e=r,l=!0;l;)for(l=!1,c=0;c<e.nodes.length;c++)if(e.nodes[c].isSelected){for(e=g()(e,{nodes:{$splice:[[c,1]]}}),u=!0;u;)for(u=!1,p=0;p<e.connections.length;p++)if(e.connections[p].from.nodeIndex===c||e.connections[p].to.nodeIndex===c){e=g()(e,{connections:{$splice:[[p,1]]}}),u=!0;break}o={},e.connections.map((function(e,n){return o[n]={to:{nodeIndex:{$set:e.to.nodeIndex>c?e.to.nodeIndex-1:e.to.nodeIndex}},from:{nodeIndex:{$set:e.from.nodeIndex>c?e.from.nodeIndex-1:e.from.nodeIndex}}},null})),e=g()(e,{connections:re({},o)}),l=!0;break}for(l=!0;l;)for(l=!1,c=0;c<e.connections.length;c++)if(e.connections[c].isSelected){e=g()(e,{connections:{$splice:[[c,1]]}}),l=!0;break}oe(e);break;case _:console.log("SELECT_NODE",i.nodeIndex,r),e=g()(r,{nodes:Object(d.a)({},i.nodeIndex,{isSelected:{$set:!0}})});break;case w:console.log("CREATE_NODE",i.x,i.y,i),e=g()(r,{nodes:{$push:[r.nodeTemplates[i.index]]}}),e=g()(e,{nodes:Object(d.a)({},e.nodes.length-1,{position:{x:{$set:i.x-r.nodeTemplates[i.index].width/2},y:{$set:i.y-10}},id:{$set:i.nodeId}})}),console.log("state after ",e),oe(e);break;case X:e=r;break;case $:console.log("CONFIRM_NODE",i.nodeId,i.sessionId,i);var f=function(e,n){var t=-1;return e.nodes.forEach((function(e,o){e.id===n&&(t=o)})),t}(r,i.nodeId);console.log("nodeIndex",f),e=g()(r,{currentSessionID:{$set:i.sessionId},nodes:Object(d.a)({},f,{nodeConfirmedInSessionWithID:{$set:i.sessionId}})});break;case G:console.log("CONFIRM_CONNECTION",i.sessionId,i),e=r;var y=function(e,n,t){return e.connections.map((function(o,s){return e.nodes[o.from.nodeIndex].id===n&&e.nodes[o.to.nodeIndex].id===t?s:-1})).filter((function(e){return-1!==e}))}(r,i.fromNodeId,i.toNodeId);console.log("connectionIndexes",y),y.forEach((function(n){e=g()(e,{currentSessionID:{$set:i.sessionId},connections:Object(d.a)({},n,{confirmedInSessionWithID:{$set:i.sessionId}})})}));break;case J:console.log("OUTPORT_DRAG_STARTED",i.nodeIndex,i.portIndex),e=g()(r,{isDragInProgress:{$set:!0},dragPayload:{$set:{type:ie,nodeIndex:i.nodeIndex,portIndex:i.portIndex}}});break;case z:console.log("INPORT_DROP",i.nodeIndex,i.portIndex),e=r,r.isDragInProgress&&r.dragPayload.type===ie&&(e=ae(e,r.dragPayload.nodeIndex,r.dragPayload.portIndex,i.nodeIndex,i.portIndex)),oe(e=ce(e));break;case U:e=ce(r);break;case B:e=g()(r,{dragMousePosition:{x:{$set:i.x},y:{$set:i.y}}});break;case W:e=g()(r,{connections:Object(d.a)({},i.connectionIndex,{isSelected:{$set:!0}})});break;case M:o={},r.nodes.map((function(e,n){return o[n]={isSelected:{$set:!1}},null})),e=g()(r,{nodes:re({},o)}),o={},r.connections.map((function(e,n){return o[n]={isSelected:{$set:!1}},null})),e=g()(e,{connections:re({},o)});break;case C:e=g()(r,{nodes:Object(d.a)({},i.index,{position:{x:{$set:i.position.x},y:{$set:i.position.y}}})});break;case P:n=i.position.x-r.nodes[i.index].position.x,t=i.position.y-r.nodes[i.index].position.y,o={},r.nodes.map((function(e,s){return s%2===0&&(o[s]={position:{x:{$set:r.nodes[s].position.x+n},y:{$set:r.nodes[s].position.y+t}}}),null})),e=g()(r,{nodes:re(Object(d.a)({},i.index,{position:{x:{$set:i.position.x},y:{$set:i.position.y}}}),o)});break;case N:var h=!r.pureHTMLgraph;e=g()(r,{pureHTMLgraph:{$set:h}});break;case k:s=r.currentSessionID,e=m(!1),e=g()(e,{currentSessionID:{$set:s}});break;case T:s=r.currentSessionID,e=m(!0),e=g()(e,{currentSessionID:{$set:s}});break;case j:console.log("CONNECT_PORTS reducer"),e=ce(e=ae(r,i.fromNodeIndex,i.fromPortIndex,i.toNodeIndex,i.toPortIndex));break;case L:console.log("SET_NODE_TEMPLATE_LIST"),e=g()(r,{nodeTemplates:{$set:i.data.nodeTemplates}});break;case A:console.log("SET_CURRENT_SESSIONID",i),e=g()(r,{currentSessionID:{$set:i.id}});break;case F:e=g()(r,{serverGraph:{nodes:{$set:[]},edges:{$set:[]}}});break;case Y:e=e=g()(r,{serverGraph:{$set:i.graph}});break;default:console.log("default ",r),e=r}return e}),{groupBy:Object(Fe.groupByActionTypes)([P,D]),filter:Object(Fe.excludeAction)([C,$,G,J,z,B,U,M,_,Y])}),en(Object(c.a)(Qe.a,nn)));i.a.render(s.a.createElement(a.a,{store:tn},s.a.createElement(qe,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[212,1,2]]]);
//# sourceMappingURL=main.d1d45636.chunk.js.map